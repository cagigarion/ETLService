{
    "id": "643e343afa67494f1d9c3f24",
    "name": "pulsar_to_mysql",
    "jobId": "6440a8aadf8956072c5fe9bd",
    "jobTaskId": "6440a8abdf8956072c5fe9be",
    "build_operation": {
        "ops": [
            {
				"type": "filter",
				"value": [
					{
						"or": [
							{
								"__comment": "specification of an op, specific to op",
								"at": "$",
								"where": {
									"field": "temperature",
									"operator": "<",
									"value": 10
								}
							},
							{
								"__comment": "specification of an op, specific to op",
								"at": "$",
								"where": {
									"field": "temperature",
									"operator": ">",
									"value": 30
								}
							},
							{
								"__comment": "specification of an op, specific to op",
								"at": "$",
								"where": {
									"field": "pressure",
									"operator": "<",
									"value": 10
								}
							},
							{
								"__comment": "specification of an op, specific to op",
								"at": "$",
								"where": {
									"field": "pressure",
									"operator": ">",
									"value": 30
								}
							},                            
                            {
								"__comment": "specification of an op, specific to op",
								"at": "$",
								"where": {
									"field": "flow_rate",
									"operator": "<",
									"value": 10
								}
							},                            
                            {
								"__comment": "specification of an op, specific to op",
								"at": "$",
								"where": {
									"field": "flow_rate",
									"operator": ">",
									"value": 30
								}
							},
                            {
								"__comment": "specification of an op, specific to op",
								"at": "$",
								"where": {
									"field": "production_volume_oil",
									"operator": "less_field",
									"value": "production_volume_oil_previous"
								}
							},
                            {
								"__comment": "specification of an op, specific to op",
								"at": "$",
								"where": {
									"field": "production_volume_gas",
									"operator": "less_field",
									"value": "production_volume_gas_previous"
								}
							},
                            {
								"__comment": "specification of an op, specific to op",
								"at": "$",
								"where": {
									"field": "production_volume_water",
									"operator": "less_field",
									"value": "production_volume_water_previous"
								}
							}
						]
					}
				]
			},
            {
				"type": "enrich",
				"value": [
					{
                        "field":"leak_oil",
                        "pattern":"sub({production_volume_oil},{production_volume_oil_previous})"
					},
                    {
                        "field":"leak_water",
                        "pattern":"sub({production_volume_water},{production_volume_water_previous})"
					},
                    {
                        "field":"leak_gas",
                        "pattern":"sub({production_volume_gas}, {production_volume_gas_previous})"
					},
                    {
                        "field":"volume_leak",
                        "pattern":"or(less({leak_oil}, 0); less({leak_water}, 0); less({production_volume_gas}, 0))"
					},
                    {
                        "field":"sensor_leak",
                        "pattern":"or(less({temperature}, 10); greater({temperature}, 30);less({pressure}, 10); greater({pressure}, 30);less({flow_rate}, 10); greater({flow_rate}, 30))"
					}
				]
			},
			{
				"type": "enrich_api",
				"value": [
					{
						"api_link": "http://localhost:3000/api/well/?well_id={well_id}&start_date=<operator>sub_minutes({timestamp}, 15)</operator>&end_date={timestamp}",
						"method": "GET",
						"body": {},
						"response_schema": {
							"fields": [
								{
									"name": "production_volume_oil_previous2",
									"pattern": "1.production_volume.oil",
									"type": "string"
								},
								{
									"name": "production_volume_gas_previous2",
									"pattern": "1.production_volume.gas",
									"type": "string"
								},
								{
									"name": "production_volume_water_previous2",
									"pattern": "1.production_volume.water",
									"type": "string"
								}
							]
						}
					}
				]
			}
		]
    },
    "userId": "641d682a4280a95d3da9168a",
    "is_enabled": true,
    "image": "etl-modules",
    "version": "latest",
    "source": {
        "id": "6424fb07a2f9c3246f4e2239",
        "type": "Pulsar",
        "name": "Pulsar",
        "hostname": "localhost",
        "port": "6650",
        "api_port": "8080",
        "tenant": "public",
        "namespace": "default",
        "api-version": "/admin/v2",
        "schema": {
            "version": 0,
            "type": "JSON",
            "timestamp": 0,
            "data": {
                "type": "record",
                "name": "SensorData",
                "fields": [
                    {
                        "name": "timestamp",
                        "type": [
                            "null",
                            "string"
                        ]
                    },
                    {
                        "name": "temperature",
                        "type": [
                            "null",
                            "int"
                        ]
                    },
                    {
                        "name": "pressure",
                        "type": [
                            "null",
                            "int"
                        ]
                    },
                    {
                        "name": "flow_rate",
                        "type": [
                            "null",
                            "int"
                        ]
                    },
                    {
                        "name": "well_id",
                        "type": [
                            "null",
                            "string"
                        ]
                    }
                ]
            },
            "properties": {}
        },
        "topic": "non-persistent://public/default/welldata"
    },
    "destinations": [
        {
            "id": "642fcc9eb568633c2affaa70",
            "type": "MySQL",
            "name": "MySQL",
            "host": "localhost",
            "port": "3306",
            "user": "mysqluser",
            "password": "mysqlpw",
            "database": "inventory",
            "ssl": false,
            "schema": {
                "create_tables": [
                    "CREATE TABLE `TankLeak` (`id` int NOT NULL AUTO_INCREMENT, well_id nvarchar(220) NULL, temperature int NULL, pressure nvarchar(220) NULL, flow_rate int NULL, timestamp nvarchar(220) NULL, production_volume_oil  nvarchar(220) NULL, production_volume_gas nvarchar(220) NULL,production_volume_water nvarchar(220) NULL,production_volume_oil_previous nvarchar(220) NULL,production_volume_gas_previous nvarchar(220) NULL,production_volume_water_previous nvarchar(220) NULL,leak_oil nvarchar(220) NULL,leak_water nvarchar(220) NULL,leak_gas nvarchar(220) NULL,volume_leak nvarchar(220) NULL,sensor_leak nvarchar(220) NULL, PRIMARY KEY (`id`)) ENGINE=InnoDB"
                ],
                "sink_to": "TankLeak",
                "select": [
                    "well_id",
                    "temperature",
                    "pressure",
                    "flow_rate",
                    "timestamp",
                    "production_volume_oil",
                    "production_volume_gas",
                    "production_volume_water",
                    "production_volume_oil_previous",
                    "production_volume_gas_previous",
                    "production_volume_water_previous",
                    "leak_oil",
                    "leak_water",
                    "leak_gas",
                    "volume_leak",
                    "sensor_leak"
                ]
            }
        },
        {
            "type": "logfile",
            "name": "Logfile",
            "schema": {
                "filename": "6440a8abdf8956072c5fe9be.log",
                "logpath": "/dataconfig/pulsar_to_mysql_643e343afa67494f1d9c3f24/logs"
            }
        }
    ]
}